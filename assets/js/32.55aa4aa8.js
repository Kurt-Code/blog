(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{333:function(a,s,t){"use strict";t.r(s);var n=t(0),e=Object(n.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"_1、环境说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、环境说明"}},[a._v("#")]),a._v(" 1、环境说明")]),a._v(" "),t("p",[a._v("环境就不进行说明了，比较三次配置，一个配过九台，每每情况各有不同。只能告知各位读者，博主这里使用的是red hat红帽，估计centOS也差不太多，不过有差异也无妨，学会博主方法，相信你就不会蒙蔽了，知道怎么往对的方向走了")]),a._v(" "),t("h1",{attrs:{id:"_2、场景说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2、场景说明"}},[a._v("#")]),a._v(" 2、场景说明")]),a._v(" "),t("p",[a._v("要求node1免密登录到node2，这里任选了一个用户，也即是")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ ssh node2\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h1",{attrs:{id:"_3、ssh登录原理过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3、ssh登录原理过程"}},[a._v("#")]),a._v(" 3、ssh登录原理过程")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdn.net/20170706191949062?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbTBfMzc1OTAxMzU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center",alt:"img"}})]),a._v(" "),t("p",[a._v("这里看不懂也没关系，楼主详解一番：")]),a._v(" "),t("p",[a._v("node1发送一个请求，问：node2，你在不在？我想连接你")]),a._v(" "),t("p",[a._v("node2查找本地是否有node1的公钥，情况一：没有，情况二：有")]),a._v(" "),t("p",[a._v("情况一：")]),a._v(" "),t("p",[a._v("node2回复说：我在！你的公钥告诉我一下。")]),a._v(" "),t("p",[a._v("node1再次发送过去，自己的公钥，")]),a._v(" "),t("p",[a._v("node2在本地进行计算，存储，得到的一串通过公钥得到的不知道什么钥，返回给node1，说：你看看对不对")]),a._v(" "),t("p",[a._v("node1告知node2：对！咱们已经建立连接了")]),a._v(" "),t("p",[a._v("node2警惕的回复node1：你知道我登录密码多少吗？")]),a._v(" "),t("p",[a._v("用户输入密码.....")]),a._v(" "),t("p",[a._v("node1把密码封装了发过去：你看是这个不？")]),a._v(" "),t("p",[a._v("node2回复：对，咱们已经建立连接！")]),a._v(" "),t("p",[a._v("情况二：")]),a._v(" "),t("p",[a._v("node2一看本地有node1的公钥，心想原来认识的，然后通过公钥计算出一个不知道什么钥匙，回复：你看看是这个钥匙吗？")]),a._v(" "),t("p",[a._v("node1告知node2：对！咱们已经建立连接了")]),a._v(" "),t("p",[a._v("node2回复node1：连接建立成功！")]),a._v(" "),t("p",[a._v("具体几次握手，博主不知道，大致就是这么个过程")]),a._v(" "),t("p",[a._v("ssh配置中，会用到下面几个文件：")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdn.net/20170706192317720?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbTBfMzc1OTAxMzU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center",alt:"img"}})]),a._v(" "),t("p",[a._v("恩~毫无PS痕迹。。。")]),a._v(" "),t("p",[a._v("1、需要在node1上生成公钥以及私钥，而id_rsa就是私钥，id_rsa.pub文件就是公钥文件。私钥我们这里就不用了，就用公钥，用完了为了保证安全性，你可以选择删掉，也可以不删，根据你的喜好决定，也就是pub文件")]),a._v(" "),t("p",[a._v("2、authorized文件，是为了方便node2的，不用询问node1的公钥本地文件，这个单词读者们需要记住，要建立这个文件！")]),a._v(" "),t("p",[a._v("3、known_hosts，表名node2是认识的主机，这个不用配置，读者可以不用管，可以作为了解原理。比如，一台新系统，.ssh目录下你会发现没有这个文件，但在你第一次ssh以后，这个文件就会生成。")]),a._v(" "),t("p",[a._v("简单说明：")]),a._v(" "),t("p",[a._v("​       上面做了原理说明，简单来说：就是node1想要连接node2免密登录node2，需要把node1的id_rsa.pub文件内容写进node2的authorized_keys里面。就大功告成了")]),a._v(" "),t("h1",{attrs:{id:"_4、最简单配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4、最简单配置"}},[a._v("#")]),a._v(" 4、最简单配置")]),a._v(" "),t("h2",{attrs:{id:"_4-1、生成公钥以及密钥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1、生成公钥以及密钥"}},[a._v("#")]),a._v(" 4.1、生成公钥以及密钥：")]),a._v(" "),t("p",[a._v("在node1上：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("~")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("keygen "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("t rsa\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("一路回车。")]),a._v(" "),t("p",[a._v('若是不想回车，可在上面代码末尾加上，-P ""')]),a._v(" "),t("h2",{attrs:{id:"_4-2、处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2、处理"}},[a._v("#")]),a._v(" 4.2、处理")]),a._v(" "),t("p",[a._v("方法一：")]),a._v(" "),t("h2",{attrs:{id:"将node1的公钥拷贝到node2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将node1的公钥拷贝到node2"}},[a._v("#")]),a._v(" 将node1的公钥拷贝到node2")]),a._v(" "),t("p",[a._v("node1上(小心别把node2的id_rsa.pub覆盖掉)")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ scp "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("p id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("pub hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("pub1\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"然后-node2将公钥加入自身认证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#然后-node2将公钥加入自身认证"}},[a._v("#")]),a._v(" 然后，node2将公钥加入自身认证")]),a._v(" "),t("p",[a._v("在node2上：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ cat id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("pub1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" authorized_key\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("验证查看文件authorized_key中是否有id_rsa.pub1文件的内容")]),a._v(" "),t("p",[a._v("方法二：")]),a._v(" "),t("h2",{attrs:{id:"直接把自己密钥拷贝到需要免密的机器上"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接把自己密钥拷贝到需要免密的机器上"}},[a._v("#")]),a._v(" 直接把自己密钥拷贝到需要免密的机器上：")]),a._v(" "),t("div",{staticClass:"language-typescript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-typescript"}},[t("code",[a._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("copy"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("id "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("i "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("~")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("id_rsa"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("pub 用户名@ip\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("将密钥文件直接拷贝到指定用户名、ip。输入密码后，下次你当前用户执行ssh到刚刚指定的用户名ip就不用再输入密码了。")]),a._v(" "),t("p",[a._v("方法二较方法一方便很多")]),a._v(" "),t("h2",{attrs:{id:"_4-4、验证-node1连接node2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4、验证-node1连接node2"}},[a._v("#")]),a._v(" 4.4、验证：node1连接node2")]),a._v(" "),t("p",[a._v("在node1上：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node1")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ssh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ ssh hadoop"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@node2")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("楼主这里没有截图，不用输入密码发现主机名变了即为成功")]),a._v(" "),t("h1",{attrs:{id:"_5、调试及常规报错解决"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5、调试及常规报错解决"}},[a._v("#")]),a._v(" 5、调试及常规报错解决")]),a._v(" "),t("h2",{attrs:{id:"_5-1、说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1、说明"}},[a._v("#")]),a._v(" 5.1、说明")]),a._v(" "),t("p",[a._v("系统日志：/var/log/secure，是个不知道干什么用的日志。ssh连接失败的报错，在这里记录")]),a._v(" "),t("h2",{attrs:{id:"_5-2、报错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2、报错"}},[a._v("#")]),a._v(" 5.2、报错")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdn.net/20170706200610227",alt:"img"}})]),a._v(" "),t("p",[a._v("解决：相关目录权限不对，一下列出相关权限。读者根据具体去修改")]),a._v(" "),t("p",[a._v("​    1、755         ~")]),a._v(" "),t("p",[a._v("​    2、700         ~/.ssh")]),a._v(" "),t("p",[a._v("​    3、644         ~/.ssh/authorized_keys(博主实测，600也可，具体的读者试试也就知道了，也不麻烦)")]),a._v(" "),t("p",[a._v("配置文件选项未开（无图）")]),a._v(" "),t("p",[a._v("这里楼主没有碰到过，所以没有图，各位读者碰到修改了就好")]),a._v(" "),t("p",[a._v("解决： vi   /etc/ssh/sshd_config")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdn.net/20170706203836282",alt:"img"}})]),a._v(" "),t("p",[a._v("这三项需要注释掉，按博主图片中这样就好。")])])}),[],!1,null,null,null);s.default=e.exports}}]);